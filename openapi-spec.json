{"openapi":"3.0.1","info":{"title":"Receiptr Backend API","description":"RESTful API for the Receiptr application with JWT authentication","contact":{"name":"Receiptr Team","url":"https://receiptr.com","email":"support@receiptr.com"},"license":{"name":"MIT License","url":"https://opensource.org/licenses/MIT"},"version":"1.0.0"},"servers":[{"url":"http://localhost:8080","description":"Development server"},{"url":"https://api.receiptr.com","description":"Production server"}],"security":[{"bearerAuth":[]}],"tags":[{"name":"Receipts","description":"Receipt management endpoints (authenticated)"},{"name":"Private Authentication","description":"Authenticated endpoints for user session management"},{"name":"Public Authentication","description":"Public endpoints for user authentication and registration"}],"paths":{"/public/refresh":{"post":{"tags":["Public Authentication"],"summary":"Refresh JWT Tokens","description":"Uses a refresh token to generate a new session/refresh token pair. Implements token rotation for security.","operationId":"refresh","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RefreshTokenRequest"}}},"required":true},"responses":{"401":{"description":"Invalid or expired refresh token","content":{"application/json":{"examples":{"Invalid Refresh Token":{"description":"Invalid Refresh Token","value":{"error":"Unauthorized","message":"Refresh token is invalid or expired"}}}}}},"200":{"description":"Tokens refreshed successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginResponse"},"examples":{"Successful Token Refresh":{"description":"Successful Token Refresh","value":{"sessionToken":"eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1c2VyLWlkLTEyMyIsInR5cGUiOiJzZXNzaW9uIiwiaWF0IjoxNjg5ODQ5MzAwLCJleHAiOjE2ODk4NTAyMDB9.newsignature","refreshToken":"eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1c2VyLWlkLTEyMyIsInR5cGUiOiJyZWZyZXNoIiwiaWF0IjoxNjg5ODQ5MzAwLCJleHAiOjE2OTI0NDE0MDB9.newsignature","sessionExpiresAt":"2023-07-20T12:30:00Z","refreshExpiresAt":"2023-08-19T12:15:00Z"}}}}}}},"security":[]}},"/public/login":{"post":{"tags":["Public Authentication"],"summary":"User Login","description":"Authenticates a user with email/password and returns JWT token pair (session + refresh tokens)","operationId":"login","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginCommand"}}},"required":true},"responses":{"200":{"description":"Login successful, returns JWT tokens","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginResponse"},"examples":{"Successful Login":{"description":"Successful Login","value":{"sessionToken":"eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1c2VyLWlkLTEyMyIsInR5cGUiOiJzZXNzaW9uIiwiaWF0IjoxNjg5ODQ4NDAwLCJleHAiOjE2ODk4NDkzMDB9.signature","refreshToken":"eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1c2VyLWlkLTEyMyIsInR5cGUiOiJyZWZyZXNoIiwiaWF0IjoxNjg5ODQ4NDAwLCJleHAiOjE2OTI0NDA0MDB9.signature","sessionExpiresAt":"2023-07-20T12:15:00Z","refreshExpiresAt":"2023-08-19T12:00:00Z"}}}}}},"401":{"description":"Authentication failed - invalid credentials","content":{"application/json":{"examples":{"Authentication Failed":{"description":"Authentication Failed","value":{"error":"Unauthorized","message":"Invalid credentials"}}}}}}},"security":[]}},"/public/createUser":{"post":{"tags":["Public Authentication"],"summary":"User Registration","description":"Creates a new user account and automatically logs them in, returning JWT tokens","operationId":"createUser","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateUserCommand"}}},"required":true},"responses":{"400":{"description":"Invalid user data or user already exists","content":{"application/json":{"examples":{"Validation Error":{"description":"Validation Error","value":{"error":"Bad Request","message":"Email already exists or invalid password format"}}}}}},"201":{"description":"User created successfully, returns JWT tokens","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginResponse"},"examples":{"Successful Registration":{"description":"Successful Registration","value":{"sessionToken":"eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1c2VyLWlkLTQ1NiIsInR5cGUiOiJzZXNzaW9uIiwiaWF0IjoxNjg5ODQ4NDAwLCJleHAiOjE2ODk4NDkzMDB9.signature","refreshToken":"eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1c2VyLWlkLTQ1NiIsInR5cGUiOiJyZWZyZXNoIiwiaWF0IjoxNjg5ODQ4NDAwLCJleHAiOjE2OTI0NDA0MDB9.signature","sessionExpiresAt":"2023-07-20T12:15:00Z","refreshExpiresAt":"2023-08-19T12:00:00Z"}}}}}}},"security":[]}},"/private/receipts":{"get":{"tags":["Receipts"],"summary":"Get All Receipts","description":"Retrieves all receipts for the authenticated user","operationId":"getAllReceipts","responses":{"200":{"description":"Receipts retrieved successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ReceiptResponse"},"examples":{"Receipt List":{"description":"Receipt List","value":[{"id":"receipt-123","description":"Grocery Shopping","amount":45.67,"createdAt":"2023-07-20T10:30:00Z"},{"id":"receipt-456","description":"Gas Station","amount":32.5,"createdAt":"2023-07-20T15:45:00Z"}]}}}}}},"security":[{"bearerAuth":[]}]},"post":{"tags":["Receipts"],"operationId":"createReceipt","requestBody":{"content":{"application/json":{"schema":{"type":"object","properties":{"request":{"$ref":"#/components/schemas/CreateReceiptRequest"},"currentUserId":{"$ref":"#/components/schemas/UserId"}}}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ReceiptResponse"}}}}},"security":[{"bearerAuth":[]}]}},"/private/logout":{"post":{"tags":["Private Authentication"],"summary":"User Logout","description":"Logs out the current user by revoking all their refresh tokens. Requires valid JWT session token.","operationId":"logout","responses":{"204":{"description":"Logout successful, all refresh tokens revoked"},"401":{"description":"Unauthorized - invalid or missing JWT token","content":{"application/json":{"examples":{"Unauthorized":{"description":"Unauthorized","value":{"error":"Unauthorized","message":"JWT token is missing or invalid"}}}}}}},"security":[{"bearerAuth":[]}]}},"/auth/login":{"post":{"tags":["auth-controller"],"operationId":"login_1","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginCommand"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/User"}}}}},"deprecated":true}},"/auth/createUser":{"post":{"tags":["auth-controller"],"operationId":"createUser_1","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateUserCommand"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/User"}}}}}}},"/public/health":{"get":{"tags":["Public Authentication"],"operationId":"health","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"string"}}}}},"security":[]}},"/private/receipts/{id}":{"get":{"tags":["Receipts"],"operationId":"getReceipt","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int64"}},{"name":"currentUserId","in":"query","required":true,"schema":{"$ref":"#/components/schemas/UserId"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ReceiptResponse"}}}}},"security":[{"bearerAuth":[]}]},"delete":{"tags":["Receipts"],"operationId":"deleteReceipt","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserId"}}}},"responses":{"200":{"description":"OK"}},"security":[{"bearerAuth":[]}]}},"/private/receipts/health":{"get":{"tags":["Receipts"],"operationId":"healthCheck","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"string"}}}}},"security":[{"bearerAuth":[]}]}}},"components":{"schemas":{"RefreshTokenRequest":{"type":"object","properties":{"refreshToken":{"type":"string"},"deviceInfo":{"type":"string"}},"description":"Refresh token request"},"JwtTokenResponse":{"type":"object","properties":{"token":{"type":"string"},"expiresAt":{"type":"string","format":"date-time"}}},"LoginResponse":{"type":"object","properties":{"sessionToken":{"$ref":"#/components/schemas/JwtTokenResponse"},"refreshToken":{"$ref":"#/components/schemas/JwtTokenResponse"}}},"LoginCommand":{"type":"object","properties":{"authMethod":{"type":"string","enum":["EMAIL_PASSWORD"]},"email":{"type":"string"},"password":{"type":"string"}},"description":"Login credentials"},"CreateUserCommand":{"type":"object","properties":{"authMethod":{"type":"string","enum":["EMAIL_PASSWORD"]},"email":{"type":"string"},"password":{"type":"string"}},"description":"User registration data"},"CreateReceiptRequest":{"type":"object","properties":{"description":{"type":"string"},"amount":{"type":"number","format":"double"}}},"UserId":{"type":"object","properties":{"value":{"type":"string","format":"uuid"}}},"ReceiptResponse":{"type":"object","properties":{"id":{"type":"integer","format":"int64"},"description":{"type":"string"},"amount":{"type":"number","format":"double"},"createdAt":{"type":"string","format":"date-time"}}},"User":{"type":"object","properties":{"id":{"$ref":"#/components/schemas/UserId"},"email":{"type":"string"},"createdAt":{"type":"string","format":"date-time"},"createdBy":{"$ref":"#/components/schemas/UserId"},"lastEditedAt":{"type":"string","format":"date-time"},"lastEditedBy":{"$ref":"#/components/schemas/UserId"}}}},"securitySchemes":{"bearerAuth":{"type":"http","description":"JWT session token for authenticated requests","scheme":"bearer","bearerFormat":"JWT"}}}}
